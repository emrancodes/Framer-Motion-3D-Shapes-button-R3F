{"ast":null,"code":"import { useContext, useRef, useLayoutEffect } from 'react';\nimport { useThree } from '@react-three/fiber';\nimport { useVisualElementContext, calcLength } from 'framer-motion';\nimport { MotionCanvasContext } from './MotionCanvasContext.mjs';\nimport { invariant } from 'hey-listen';\nimport { clamp } from 'popmotion';\nvar calcBoxSize = function (_a) {\n  var x = _a.x,\n    y = _a.y;\n  return {\n    width: calcLength(x),\n    height: calcLength(y)\n  };\n};\nfunction useLayoutCamera(_a, updateCamera) {\n  var _b = _a.makeDefault,\n    makeDefault = _b === void 0 ? true : _b;\n  var context = useContext(MotionCanvasContext);\n  invariant(Boolean(context), \"No MotionCanvas detected. Replace Canvas from @react-three/fiber with MotionCanvas from framer-motion.\");\n  var _c = context,\n    dimensions = _c.dimensions,\n    layoutCamera = _c.layoutCamera,\n    requestedDpr = _c.requestedDpr;\n  var advance = useThree(function (three) {\n    return three.advance;\n  });\n  var set = useThree(function (three) {\n    return three.set;\n  });\n  var camera = useThree(function (three) {\n    return three.camera;\n  });\n  var size = useThree(function (three) {\n    return three.size;\n  });\n  var gl = useThree(function (three) {\n    return three.gl;\n  });\n  var parentVisualElement = useVisualElementContext();\n  var measuredLayoutSize = useRef();\n  useLayoutEffect(function () {\n    measuredLayoutSize.current = size;\n    updateCamera(size);\n    advance(performance.now());\n    var projection = parentVisualElement === null || parentVisualElement === void 0 ? void 0 : parentVisualElement.projection;\n    if (!projection) return;\n    /**\n     * When the projection of an element changes we want to update the camera\n     * with the projected dimensions.\n     */\n    var removeProjectionUpdateListener = projection.addEventListener(\"projectionUpdate\", function (newProjection) {\n      return updateCamera(calcBoxSize(newProjection));\n    });\n    /**\n     * When the layout of an element changes we want to update the renderer\n     * output to match the layout dimensions.\n     */\n    var removeLayoutMeasureListener = projection.addEventListener(\"measure\", function (newLayout) {\n      var newSize = calcBoxSize(newLayout);\n      var dpr = requestedDpr;\n      var _a = dimensions.current.size,\n        width = _a.width,\n        height = _a.height;\n      var xScale = width / newSize.width;\n      var yScale = height / newSize.height;\n      var maxScale = Math.max(xScale, yScale);\n      dpr = clamp(0.75, 4, maxScale);\n      dimensions.current = {\n        size: {\n          width: newSize.width,\n          height: newSize.height\n        },\n        dpr: dpr\n      };\n      gl.setSize(newSize.width, newSize.height);\n      gl.setPixelRatio(dpr);\n    });\n    /**\n     * When a projection animation completes we want to update the camera to\n     * match the recorded layout of the element.\n     */\n    var removeAnimationCompleteListener = projection.addEventListener(\"animationComplete\", function () {\n      var actual = (projection.layout || {}).actual;\n      if (actual) {\n        setTimeout(function () {\n          var newSize = calcBoxSize(actual);\n          updateCamera(newSize);\n          dimensions.current = {\n            size: newSize\n          };\n          gl.setSize(newSize.width, newSize.height);\n          gl.setPixelRatio(requestedDpr);\n        }, 50);\n      }\n    });\n    return function () {\n      removeProjectionUpdateListener();\n      removeLayoutMeasureListener();\n      removeAnimationCompleteListener();\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  useLayoutEffect(function () {\n    var cam = layoutCamera.current;\n    if (makeDefault && cam) {\n      var oldCam_1 = camera;\n      set(function () {\n        return {\n          camera: cam\n        };\n      });\n      return function () {\n        return set(function () {\n          return {\n            camera: oldCam_1\n          };\n        });\n      };\n    }\n  }, [camera, layoutCamera, makeDefault, set]);\n  return {\n    size: size,\n    camera: camera,\n    cameraRef: layoutCamera\n  };\n}\nexport { useLayoutCamera };","map":{"version":3,"names":["useContext","useRef","useLayoutEffect","useThree","useVisualElementContext","calcLength","MotionCanvasContext","invariant","clamp","calcBoxSize","_a","x","y","width","height","useLayoutCamera","updateCamera","_b","makeDefault","context","Boolean","_c","dimensions","layoutCamera","requestedDpr","advance","three","set","camera","size","gl","parentVisualElement","measuredLayoutSize","current","performance","now","projection","removeProjectionUpdateListener","addEventListener","newProjection","removeLayoutMeasureListener","newLayout","newSize","dpr","xScale","yScale","maxScale","Math","max","setSize","setPixelRatio","removeAnimationCompleteListener","actual","layout","setTimeout","cam","oldCam_1","cameraRef"],"sources":["C:/Users/emran/Documents/GitHub/Framer-Motion-3D-Shapes-button-R3F/node_modules/framer-motion-3d/dist/es/components/use-layout-camera.mjs"],"sourcesContent":["import { useContext, useRef, useLayoutEffect } from 'react';\nimport { useThree } from '@react-three/fiber';\nimport { useVisualElementContext, calcLength } from 'framer-motion';\nimport { MotionCanvasContext } from './MotionCanvasContext.mjs';\nimport { invariant } from 'hey-listen';\nimport { clamp } from 'popmotion';\n\nvar calcBoxSize = function (_a) {\n    var x = _a.x, y = _a.y;\n    return ({\n        width: calcLength(x),\n        height: calcLength(y),\n    });\n};\nfunction useLayoutCamera(_a, updateCamera) {\n    var _b = _a.makeDefault, makeDefault = _b === void 0 ? true : _b;\n    var context = useContext(MotionCanvasContext);\n    invariant(Boolean(context), \"No MotionCanvas detected. Replace Canvas from @react-three/fiber with MotionCanvas from framer-motion.\");\n    var _c = context, dimensions = _c.dimensions, layoutCamera = _c.layoutCamera, requestedDpr = _c.requestedDpr;\n    var advance = useThree(function (three) { return three.advance; });\n    var set = useThree(function (three) { return three.set; });\n    var camera = useThree(function (three) { return three.camera; });\n    var size = useThree(function (three) { return three.size; });\n    var gl = useThree(function (three) { return three.gl; });\n    var parentVisualElement = useVisualElementContext();\n    var measuredLayoutSize = useRef();\n    useLayoutEffect(function () {\n        measuredLayoutSize.current = size;\n        updateCamera(size);\n        advance(performance.now());\n        var projection = parentVisualElement === null || parentVisualElement === void 0 ? void 0 : parentVisualElement.projection;\n        if (!projection)\n            return;\n        /**\n         * When the projection of an element changes we want to update the camera\n         * with the projected dimensions.\n         */\n        var removeProjectionUpdateListener = projection.addEventListener(\"projectionUpdate\", function (newProjection) { return updateCamera(calcBoxSize(newProjection)); });\n        /**\n         * When the layout of an element changes we want to update the renderer\n         * output to match the layout dimensions.\n         */\n        var removeLayoutMeasureListener = projection.addEventListener(\"measure\", function (newLayout) {\n            var newSize = calcBoxSize(newLayout);\n            var dpr = requestedDpr;\n            var _a = dimensions.current.size, width = _a.width, height = _a.height;\n            var xScale = width / newSize.width;\n            var yScale = height / newSize.height;\n            var maxScale = Math.max(xScale, yScale);\n            dpr = clamp(0.75, 4, maxScale);\n            dimensions.current = {\n                size: { width: newSize.width, height: newSize.height },\n                dpr: dpr,\n            };\n            gl.setSize(newSize.width, newSize.height);\n            gl.setPixelRatio(dpr);\n        });\n        /**\n         * When a projection animation completes we want to update the camera to\n         * match the recorded layout of the element.\n         */\n        var removeAnimationCompleteListener = projection.addEventListener(\"animationComplete\", function () {\n            var actual = (projection.layout || {}).actual;\n            if (actual) {\n                setTimeout(function () {\n                    var newSize = calcBoxSize(actual);\n                    updateCamera(newSize);\n                    dimensions.current = { size: newSize };\n                    gl.setSize(newSize.width, newSize.height);\n                    gl.setPixelRatio(requestedDpr);\n                }, 50);\n            }\n        });\n        return function () {\n            removeProjectionUpdateListener();\n            removeLayoutMeasureListener();\n            removeAnimationCompleteListener();\n        };\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, []);\n    useLayoutEffect(function () {\n        var cam = layoutCamera.current;\n        if (makeDefault && cam) {\n            var oldCam_1 = camera;\n            set(function () { return ({ camera: cam }); });\n            return function () { return set(function () { return ({ camera: oldCam_1 }); }); };\n        }\n    }, [camera, layoutCamera, makeDefault, set]);\n    return { size: size, camera: camera, cameraRef: layoutCamera };\n}\n\nexport { useLayoutCamera };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}